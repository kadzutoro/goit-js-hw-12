{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["import axios from 'axios';\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\nfunction showMessage(message) {\n    iziToast.show({\n      close: false,\n      closeOnClick: true,\n      message,\n      messageColor: 'white',\n      timeout: 3000,\n      transitionIn: 'flipInX',\n      transitionOut: 'flipOutX',\n      position: 'topRight',\n      backgroundColor: 'red',\n      progressBar: false,\n    });\n  }\n\nconst loader = document.querySelector('.loader')\nconst input = document.querySelector(\".search-input\")\nconst form = document.querySelector(\".form\")\nconst loadImagesBtn = document.querySelector('#loadBtn')\nconst gallery = document.querySelector('#gallery')\nlet lightbox = new SimpleLightbox('.gallery a', { showCounter: false });\nconst API_KEY = '41936359-935dea1b7e7e76694a23c8d00';\nconst API_BASE_URL = 'https://pixabay.com/api/';\naxios.defaults.baseURL = API_BASE_URL;\n\nlet scrollOffset = innerHeight;\nlet page = 1;\nconst per_page = 40;\nlet userSearchRequest;\n\nwindow.scrollBy(0, scrollOffset);\n\nform.addEventListener('submit', handleFormSubmit);\nloadImagesBtn.addEventListener('click', loadMoreImages);\n\nasync function handleFormSubmit(e) {\n  e.preventDefault();\n  resetGallery();\n  userSearchRequest = input.value;\n  await fetchNRender();\n}\n\nasync function fetchNRender() {\n    try {\n      const response = await axios.get(API_BASE_URL, {params: getAPIParams(),});\n      const images = response.data;\n      if (images.hits.length === 0) {\n        return showMessage('Sorry, no images match your search query. Please try again!');\n      }\n      renderImages(images.hits);\n      handleLoadMoreButton(images.totalHits);\n    } catch (error) {\n        console.error(\"API request error:\", error);\n        handleAPIError();\n    } finally {\n      loader.classList.add('is-hidden');\n    }\n}\n\nfunction renderImages(images) {\n    page += 1;\n    const htmlString = images.reduce (\n          (html, {largeImageURL,webformatURL,tags,likes,views,comments,downloads}) => html + `<li class=\"gallery-item\">\n              <a href=\"${largeImageURL}\">\n              <img src=\"${webformatURL}\" alt=\"${tags}\" />\n              </a>\n              <div class=\"image-desc\">\n              <div class=\"image-desc-item\">\n              <div class=\"image-desc-label\">Likes</div>\n              <div>${likes}</div>\n              </div>\n              <div class=\"image-desc-item\">\n              <div class=\"image-desc-label\">Views</div>\n              <div>${views}</div>\n              </div>\n              <div class=\"image-desc-item\">\n              <div class=\"image-desc-label\">Comments</div>\n              <div>${comments}</div>\n              </div>\n              <div class=\"image-desc-item\">\n              <div class=\"image-desc-label\">Downloads</div>\n              <div>${downloads}</div>\n              </div>\n              </div>\n              </li>`, \"\"\n              ); \n\n    gallery.insertAdjacentHTML('beforeend', htmlString);\n    scrollOffset = document\n    .querySelector('.gallery-item:last-child')\n    .getBoundingClientRect().height;\n\n lightbox.refresh();\n}\n\nasync function loadMoreImages() {\n    loadImagesBtn.classList.add('is-hidden');\n    loader.classList.remove('is-hidden');\n    await fetchNRender();\n}\n\nfunction resetGallery() {\n    loadImagesBtn.classList.add('is-hidden');\n    loader.classList.remove('is-hidden');\n    page = 1;\n    gallery.innerHTML = '';\n}\n\nfunction getAPIParams() {\n    return {\n      key: API_KEY,\n      q: userSearchRequest,\n      orientation: 'horizontal',\n      image_type: 'photo',\n      safesearch: true,\n      page,\n      per_page,\n    };\n}\n\nfunction handleLoadMoreButton(totalHits) {\n    const totalPages = Math.ceil(totalHits / per_page);\n    if (page > totalPages) {\n      showMessage(\"We're sorry, but you've reached the end of search results.\");\n    } else {\n      loadImagesBtn.classList.remove('is-hidden');\n    }\n}\n  \nfunction handleAPIError(error) {\n    console.error(\"API request error:\", error);\n    showMessage('Oops... Something went wrong. Please try again later.');  \n}"],"names":["showMessage","message","iziToast","loader","input","form","loadImagesBtn","gallery","lightbox","SimpleLightbox","API_KEY","API_BASE_URL","axios","scrollOffset","page","per_page","userSearchRequest","handleFormSubmit","loadMoreImages","e","resetGallery","fetchNRender","images","getAPIParams","renderImages","handleLoadMoreButton","error","handleAPIError","htmlString","html","largeImageURL","webformatURL","tags","likes","views","comments","downloads","totalHits","totalPages"],"mappings":"owBAMA,SAASA,EAAYC,EAAS,CAC1BC,EAAS,KAAK,CACZ,MAAO,GACP,aAAc,GACd,QAAAD,EACA,aAAc,QACd,QAAS,IACT,aAAc,UACd,cAAe,WACf,SAAU,WACV,gBAAiB,MACjB,YAAa,EACnB,CAAK,CACF,CAEH,MAAME,EAAS,SAAS,cAAc,SAAS,EACzCC,EAAQ,SAAS,cAAc,eAAe,EAC9CC,EAAO,SAAS,cAAc,OAAO,EACrCC,EAAgB,SAAS,cAAc,UAAU,EACjDC,EAAU,SAAS,cAAc,UAAU,EACjD,IAAIC,EAAW,IAAIC,EAAe,aAAc,CAAE,YAAa,EAAK,CAAE,EACtE,MAAMC,EAAU,qCACVC,EAAe,2BACrBC,EAAM,SAAS,QAAUD,EAEzB,IAAIE,EAAe,YACfC,EAAO,EACX,MAAMC,EAAW,GACjB,IAAIC,EAEJ,OAAO,SAAS,EAAGH,CAAY,EAE/BR,EAAK,iBAAiB,SAAUY,CAAgB,EAChDX,EAAc,iBAAiB,QAASY,CAAc,EAEtD,eAAeD,EAAiBE,EAAG,CACjCA,EAAE,eAAc,EAChBC,IACAJ,EAAoBZ,EAAM,MAC1B,MAAMiB,EAAY,CACpB,CAEA,eAAeA,GAAe,CAC1B,GAAI,CAEF,MAAMC,GADW,MAAMV,EAAM,IAAID,EAAc,CAAC,OAAQY,EAAc,CAAA,CAAE,GAChD,KACxB,GAAID,EAAO,KAAK,SAAW,EACzB,OAAOtB,EAAY,6DAA6D,EAElFwB,EAAaF,EAAO,IAAI,EACxBG,EAAqBH,EAAO,SAAS,CACtC,OAAQI,EAAP,CACE,QAAQ,MAAM,qBAAsBA,CAAK,EACzCC,GACR,QAAc,CACRxB,EAAO,UAAU,IAAI,WAAW,CACjC,CACL,CAEA,SAASqB,EAAaF,EAAQ,CAC1BR,GAAQ,EACR,MAAMc,EAAaN,EAAO,OACpB,CAACO,EAAM,CAAC,cAAAC,EAAc,aAAAC,EAAa,KAAAC,EAAK,MAAAC,EAAM,MAAAC,EAAM,SAAAC,EAAS,UAAAC,CAAS,IAAMP,EAAO;AAAA,yBACpEC;AAAA,0BACCC,WAAsBC;AAAA;AAAA;AAAA;AAAA;AAAA,qBAK3BC;AAAA;AAAA;AAAA;AAAA,qBAIAC;AAAA;AAAA;AAAA;AAAA,qBAIAC;AAAA;AAAA;AAAA;AAAA,qBAIAC;AAAA;AAAA;AAAA,qBAGC,EACtB,EAEI7B,EAAQ,mBAAmB,YAAaqB,CAAU,EAClDf,EAAe,SACd,cAAc,0BAA0B,EACxC,sBAAqB,EAAG,OAE5BL,EAAS,QAAO,CACjB,CAEA,eAAeU,GAAiB,CAC5BZ,EAAc,UAAU,IAAI,WAAW,EACvCH,EAAO,UAAU,OAAO,WAAW,EACnC,MAAMkB,EAAY,CACtB,CAEA,SAASD,GAAe,CACpBd,EAAc,UAAU,IAAI,WAAW,EACvCH,EAAO,UAAU,OAAO,WAAW,EACnCW,EAAO,EACPP,EAAQ,UAAY,EACxB,CAEA,SAASgB,GAAe,CACpB,MAAO,CACL,IAAKb,EACL,EAAGM,EACH,YAAa,aACb,WAAY,QACZ,WAAY,GACZ,KAAAF,EACA,SAAAC,CACN,CACA,CAEA,SAASU,EAAqBY,EAAW,CACrC,MAAMC,EAAa,KAAK,KAAKD,EAAYtB,CAAQ,EAC7CD,EAAOwB,EACTtC,EAAY,4DAA4D,EAExEM,EAAc,UAAU,OAAO,WAAW,CAEhD,CAEA,SAASqB,EAAeD,EAAO,CAC3B,QAAQ,MAAM,qBAAsBA,CAAK,EACzC1B,EAAY,uDAAuD,CACvE"}